# View: v_rhh_wordofficeBPO

## Usa los objetos:
- [[gen_ccosto]]
- [[gen_compania]]
- [[rhh_Intconta_detalle]]
- [[rhh_tipliquid]]

```sql

CREATE VIEW [dbo].[v_rhh_wordofficeBPO]
AS
-- vista plano WordOffice
--CABEZA
SELECT 'Encab: Empresa' AS cEmpresa,
	  'Encab: Tipo Documento' AS ctipdoc,
	  'Encab: Prefijo' AS cprefijo,
	  'Encab: Documento Número' AS cnumdoc,
	  'Encab: Fecha' AS cfecha,
	  'Encab: Tercero Interno' AS ctercInt,
	  'Encab: Tercero Externo' AS ctercExt,
	  'Encab: Nota' AS cCNota,
	  'Encab: Verificado' AS cverificado,
	  'Encab: Anulado' AS canulado,
	  'Encab: Sucursal' AS cSucursal,
	  'Encab: Clasificación' AS cCl0,
	  'Encab: Personalizado 1' AS cCl1,
	  'Encab: Personalizado 2' AS cCl2,
	  'Encab: Personalizado 3' AS cCl3,
	  'Encab: Personalizado 4' AS cCl4,
	  'Encab: Personalizado 5' AS cCl5,
	  'Encab: Personalizado 6' AS cCl6,
	  'Encab: Personalizado 7' AS cCl7,
	  'Encab: Personalizado 8' AS cCl8,
	  'Encab: Personalizado 9' AS cCl9,
	  'Encab: Personalizado 10' AS cCl10,
	  'Encab: Personalizado 11' AS cCl11,
	  'Encab: Personalizado 12' AS cCl12,
	  'Encab: Personalizado 13' AS cCl13,
	  'Encab: Personalizado 14' AS cCl14,
	  'Encab: Personalizado 15' AS cCl15,
	  'Detalle Con: IdCuentaContable' AS cIdCuenta,
	  'Detalle Con: Nota' AS cNota,
	  'Detalle Con: Tercero_Externo' AS cTerceroExt,
	  'Detalle Con: Cheque' AS cCheque,
	  'Detalle Con: Débito' AS cDebito,
	  'Detalle Con: Crédito' AS cCredito,
	  'Detalle Con: Vencimiento' AS cVencimiento,
	  'Detalle Con: Centro costos' AS cCentcostos,
	  'Detalle Con: Activo Fijo' AS cActivoFijo,
	  'Detalle Con: Tipo_Base' AS cTipoBase,
	  'Detalle Con: Porcentaje_Retención' AS cPorcentajeRet,
	  'Detalle Con: BaseRetención' AS cBaseRetencion,
	  'Detalle Con: PagoRetención' AS cPagoRetencion,
	  'Detalle Con: IVAalCosto' AS cIVAalCosto,
	  'Detalle Con: Sucursal' AS cDSucursal,
	  'Detalle Con: Importación' AS cImportacion,
	  'Detalle Con: Caja Menor' AS cCajaMenor,
	  'Detalle Con: Excluir NIIF' AS cExcluirNIIF,
	  'Detalle Con: ImpoConsumoCosto' AS cImpoConsumo,
	  'Detalle Con: No Deducible' AS cNoDeducible,
	  'Detalle Con: Código Centro Costos' AS cCodigoCCostos,
	  --CUERPO
	  nom_cia AS Empresa,
	  'NO' AS tipdoc,
	  '    ' AS prefijo,
	  D.num_doc AS numdoc,
	  CONVERT(VARCHAR(10), fch_doc, 103) AS fecha,
	  '51921344' AS tercInt,
	  '51921344' AS tercExt,
	  RTRIM(LTRIM(nom_liq)) + ' ' + CONVERT(VARCHAR(10), fch_doc, 112) AS Nota,
	  '0' AS verificado,
	  '0' AS anulado,
	  '' AS Sucursal,
	  '' AS Cl0,
	  '' AS Cl1,
	  '' AS Cl2,
	  '' AS Cl3,
	  '' AS Cl4,
	  '' AS Cl5,
	  '' AS Cl6,
	  '' AS Cl7,
	  '' AS Cl8,
	  '' AS Cl9,
	  '' AS Cl10,
	  '' AS Cl11,
	  '' AS Cl12,
	  '' AS Cl13,
	  '' AS Cl14,
	  '' AS Cl15,
	  COD_CUE AS IdCuenta,
	  des_con AS dNota,
	  cod_ter AS TerceroExt,
	  '' AS Cheque,
	  CONVERT(INT, SUM(deb_mov)) AS Debito,
	  CONVERT(INT, SUM(cre_mov)) AS Credito,
	  CONVERT(VARCHAR(10), fch_doc, 103) AS Vencimiento,
	  nom_cco AS Centcostos, --VALIDAR  QUE COMIENCREN CON 5 O 7 
	  '' AS ActivoFijo,
	  '' AS TipoBase,
	  '' AS PorcentajeRet,
	  '' AS BaseRetencion,
	  '' AS PagoRetencion,
	  '' AS IVAalCosto,
	  '' AS DSucursal,
	  '' AS Importacion,
	  '' AS CajaMenor,
	  '' AS ExcluirNIIF,
	  '' AS ImpoConsumo,
	  '' AS NoDeducible,
	  D.COD_CCO AS CodigoCCostos,
	  D.sub_tip,
	  D.num_doc
FROM rhh_Intconta_detalle AS D
INNER JOIN gen_compania AS Cia ON D.cod_cia = Cia.cod_cia
INNER JOIN gen_ccosto AS Cco ON D.cod_cco = Cco.cod_cco
INNER JOIN rhh_tipliquid AS L ON D.tip_liq = L.tip_liq
GROUP BY D.num_doc,
	    nom_cia,
	    D.cod_emp,
	    D.fec_Cte,
	    D.fch_doc,
	    nom_liq,
	    d.cod_Con,
	    des_con,
	    nom_cco,
	    D.cod_cco,
	    D.sub_tip,
	    D.num_doc,
	    cod_ter,
	    D.sub_tip,
	    cod_cue;

```
